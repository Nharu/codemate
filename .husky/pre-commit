#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Frontend checks
if [ -d "frontend" ]; then
  echo "ğŸ“ Checking frontend..."
  cd frontend
  echo "  âœ¨ Prettier format..."
  npx prettier --write "src/**/*.{ts,tsx,js,jsx,json,css,md}"
  echo "  ğŸ”§ ESLint fix..."
  npx eslint "src/**/*.{ts,tsx,js,jsx}" --fix
  echo "  ğŸ” Type checking..."
  npx tsc --noEmit
  cd ..
fi

# Backend checks
if [ -d "backend" ]; then
  echo "ğŸ“ Checking backend..."
  cd backend
  echo "  âœ¨ Prettier format..."
  npx prettier --write "src/**/*.{ts,js,json}"
  echo "  ğŸ”§ ESLint fix..."
  npx eslint "src/**/*.ts" --fix
  echo "  ğŸ” Type checking..."
  npx tsc --noEmit
  cd ..
fi

# Add formatted files back to git
git add .

echo "âœ… All checks passed!"